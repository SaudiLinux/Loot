#!/usr/bin/env python3
"""
Master Exploitation Tool - وضع الهدف وتشغيل جميع الأدوات
Master Exploitation Tool - Set Target and Run All Tools
"""

import sys
import subprocess
import datetime
import argparse

def show_banner():
    print("""
    ╔══════════════════════════════════════════════════════════════╗
    ║                                                              ║
    ║              🎯 أداة الاستغلال الرئيسية 🎯                 ║
    ║                 Master Exploitation Tool                     ║
    ║                                                              ║
    ║          وضع الهدف وتشغيل جميع الأدوات في أمر واحد         ║
    ║        Set Target and Run All Tools in One Command         ║
    ║                                                              ║
    ╚══════════════════════════════════════════════════════════════╝
    """)

def run_target_exploitation(target):
    """Run target exploitation with all tools"""
    timestamp = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
    
    print(f"\n🎯 الهدف المحدد: {target}")
    print(f"📅 الوقت: {datetime.datetime.now()}")
    print("=" * 60)
    
    # Run the main target exploitation script
    cmd = f"python target_exploit.py --target {target}"
    print(f"🚀 تشغيل: {cmd}")
    
    try:
        result = subprocess.run(cmd, shell=True)
        success = result.returncode == 0
        
        if success:
            print(f"\n✅ تم استغلال الهدف {target} بنجاح!")
            print(f"📁 تم إنشاء التقارير والنتائج")
        else:
            print(f"\n⚠️  تم التنفيذ مع بعض التحذيرات")
        
        return success
    except Exception as e:
        print(f"❌ خطأ: {e}")
        return False

def main():
    show_banner()
    
    # Create argument parser
    parser = argparse.ArgumentParser(
        description="وضع الهدف وتشغيل جميع أدوات الاستغلال",
        formatter_class=argparse.RawDescriptionHelpFormatter,
        epilog="""
الأمثلة:
  python master_exploit.py 192.168.1.1
  python master_exploit.py example.com
  python master_exploit.py --target 10.0.0.1
        """
    )
    
    parser.add_argument("target", nargs="?", help="الهدف (IP أو دومين)")
    parser.add_argument("--target", "-t", help="الهدف (IP أو دومين) - خيار بديل")
    
    args = parser.parse_args()
    
    # Get target from either positional or named argument
    target = args.target or args.target
    
    if not target:
        print("❌ يرجى تحديد الهدف")
        print("الاستخدام: python master_exploit.py [الهدف]")
        print("مثال: python master_exploit.py 192.168.1.1")
        print("مثال: python master_exploit.py example.com")
        sys.exit(1)
    
    # Run exploitation
    success = run_target_exploitation(target)
    
    if success:
        print(f"\n🎉 اكتملت عملية استغلال الهدف {target} بنجاح!")
    else:
        print(f"\n⚠️  تم استكمال التنفيذ مع بعض التحذيرات")

if __name__ == "__main__":
    main()