#!/usr/bin/env python3
"""
Master script to run all exploitation tools at once
Ø¬Ù…ÙŠØ¹ Ø£Ø¯ÙˆØ§Øª Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø«ØºØ±Ø§Øª ÙÙŠ Ø£Ù…Ø± ÙˆØ§Ø­Ø¯
"""

import subprocess
import sys
import time
import datetime
import json
import os

def run_tool(tool_name, command):
    """Run a tool and capture its output"""
    print(f"\n{'='*60}")
    print(f"ğŸš€ ØªØ´ØºÙŠÙ„: {tool_name}")
    print(f"Ø§Ù„Ø£Ù…Ø±: {command}")
    print(f"{'='*60}")
    
    try:
        result = subprocess.run(command, shell=True, capture_output=True, text=True, timeout=300)
        print(f"âœ… ØªÙ… Ø¨Ù†Ø¬Ø§Ø­ - Ø±Ù…Ø² Ø§Ù„Ø®Ø±ÙˆØ¬: {result.returncode}")
        if result.stdout:
            print(f"Ø§Ù„Ù…Ø®Ø±Ø¬Ø§Øª:\n{result.stdout[:500]}...")  # Show first 500 chars
        if result.stderr:
            print(f"Ø§Ù„Ø£Ø®Ø·Ø§Ø¡:\n{result.stderr[:300]}...")  # Show first 300 chars
        return True
    except subprocess.TimeoutExpired:
        print(f"â° Ø§Ù†ØªÙ‡Øª Ø§Ù„Ù…Ù‡Ù„Ø© Ù„Ù€ {tool_name}")
        return False
    except Exception as e:
        print(f"âŒ Ø®Ø·Ø£ ÙÙŠ {tool_name}: {str(e)}")
        return False

def main():
    """Run all exploitation tools"""
    print("""
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘               Ø£Ø¯ÙˆØ§Øª Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø«ØºØ±Ø§Øª - ØªØ´ØºÙŠÙ„ Ø´Ø§Ù…Ù„                   â•‘
    â•‘              Vulnerability Exploitation Tools - Full Run             â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    """)
    
    # Get current timestamp
    timestamp = datetime.datetime.now().strftime("%Y%m%d_%H%M%S")
    
    # Define all tools to run
    tools = [
        {
            "name": "Practical Exploitation Tool",
            "command": f"python practical_exploitation.py --demo all --output exploitation_full_{timestamp}.json",
            "description": "Ø£Ø¯Ø§Ø© Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø¹Ù…Ù„ÙŠ Ù„Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø«ØºØ±Ø§Øª"
        },
        {
            "name": "Proof of Concept Tool", 
            "command": "python poc_exploitation.py --target http://example-vulnerable-app.com --test all",
            "description": "Ø£Ø¯Ø§Ø© Ø§Ø«Ø¨Ø§Øª Ø§Ù„Ù…ÙÙ‡ÙˆÙ… Ù„Ù„Ø«ØºØ±Ø§Øª"
        },
        {
            "name": "Arabic Exploitation Demo",
            "command": "python arabic_exploitation_demo.py --demo all",
            "description": "Ø§Ù„Ø¹Ø±Ø¶ Ø§Ù„ØªÙˆØ¶ÙŠØ­ÙŠ Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©"
        },
        {
            "name": "Zero Day Tool",
            "command": "python zero_day_tool.py --demo-mode",
            "description": "Ø£Ø¯Ø§Ø© Ø§Ù„Ø«ØºØ±Ø§Øª Ø§Ù„ØµÙØ±ÙŠØ©"
        },
        {
            "name": "Exploitation Tools Module",
            "command": "python exploitation_tools.py --demo",
            "description": "ÙˆØ­Ø¯Ø© Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„"
        }
    ]
    
    # Track results
    results = {
        "timestamp": timestamp,
        "total_tools": len(tools),
        "successful_tools": 0,
        "failed_tools": 0,
        "tool_results": []
    }
    
    print(f"ğŸ“… Ø¨Ø¯Ø¡ Ø§Ù„ØªØ´ØºÙŠÙ„: {datetime.datetime.now()}")
    print(f"ğŸ› ï¸ Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø¯ÙˆØ§Øª: {len(tools)}")
    print(f"ğŸ“ Ø³ÙŠØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ: exploitation_full_{timestamp}.json")
    
    # Run each tool
    for i, tool in enumerate(tools, 1):
        print(f"\nğŸ“‹ [{i}/{len(tools)}] {tool['name']}")
        print(f"ğŸ“ {tool['description']}")
        
        success = run_tool(tool['name'], tool['command'])
        
        tool_result = {
            "name": tool['name'],
            "command": tool['command'],
            "description": tool['description'],
            "success": success,
            "timestamp": datetime.datetime.now().isoformat()
        }
        results["tool_results"].append(tool_result)
        
        if success:
            results["successful_tools"] += 1
        else:
            results["failed_tools"] += 1
            
        # Small delay between tools
        time.sleep(2)
    
    # Generate summary report
    print(f"\n{'='*60}")
    print("ğŸ“Š Ù…Ù„Ø®Øµ Ø§Ù„Ù†ØªØ§Ø¦Ø¬")
    print(f"{'='*60}")
    print(f"âœ… Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ø§Ø¬Ø­Ø©: {results['successful_tools']}/{results['total_tools']}")
    print(f"âŒ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„ÙØ§Ø´Ù„Ø©: {results['failed_tools']}/{results['total_tools']}")
    print(f"ğŸ“ˆ Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­: {(results['successful_tools']/results['total_tools']*100):.1f}%")
    
    # Save results to file
    results_file = f"exploitation_master_results_{timestamp}.json"
    with open(results_file, 'w', encoding='utf-8') as f:
        json.dump(results, f, ensure_ascii=False, indent=2)
    
    print(f"\nğŸ’¾ ØªÙ… Ø­ÙØ¸ Ø§Ù„Ù†ØªØ§Ø¦Ø¬ ÙÙŠ: {results_file}")
    
    # Generate final report
    generate_final_report(results, timestamp)
    
    print(f"\nğŸ‰ Ø§ÙƒØªÙ…Ù„ ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ø¯ÙˆØ§Øª!")
    print(f"â° ÙˆÙ‚Øª Ø§Ù„Ø§Ù†ØªÙ‡Ø§Ø¡: {datetime.datetime.now()}")

def generate_final_report(results, timestamp):
    """Generate a final comprehensive report"""
    report_content = f"""# ØªÙ‚Ø±ÙŠØ± Ù†Ù‡Ø§Ø¦ÙŠ: ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø£Ø¯ÙˆØ§Øª Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø«ØºØ±Ø§Øª

## Ù…Ø¹Ù„ÙˆÙ…Ø§Øª Ø§Ù„ØªØ´ØºÙŠÙ„
- **Ø§Ù„ØªØ§Ø±ÙŠØ® ÙˆØ§Ù„ÙˆÙ‚Øª**: {datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")}
- **Ù…Ø¹Ø±Ù Ø§Ù„ØªØ´ØºÙŠÙ„**: {timestamp}
- **Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø£Ø¯ÙˆØ§Øª**: {results['total_tools']}
- **Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù†Ø§Ø¬Ø­Ø©**: {results['successful_tools']}
- **Ù†Ø³Ø¨Ø© Ø§Ù„Ù†Ø¬Ø§Ø­**: {(results['successful_tools']/results['total_tools']*100):.1f}%

## Ù†ØªØ§Ø¦Ø¬ ÙƒÙ„ Ø£Ø¯Ø§Ø©

"""
    
    for tool_result in results['tool_results']:
        status = "âœ… Ù†Ø§Ø¬Ø­" if tool_result['success'] else "âŒ ÙØ§Ø´Ù„"
        report_content += f"""
### {tool_result['name']}
- **Ø§Ù„Ø­Ø§Ù„Ø©**: {status}
- **Ø§Ù„ÙˆØµÙ**: {tool_result['description']}
- **Ø§Ù„Ø£Ù…Ø±**: `{tool_result['command']}`
- **Ø§Ù„ÙˆÙ‚Øª**: {tool_result['timestamp']}

"""
    
    report_content += f"""
## Ø§Ù„ØªÙˆØµÙŠØ§Øª

### Ù„Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„Ù†Ø§Ø¬Ø­Ø©:
- âœ… ØªÙ… ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø¨Ù†Ø¬Ø§Ø­ ÙˆØ¥Ù†ØªØ§Ø¬ ØªÙ‚Ø§Ø±ÙŠØ± Ù…ÙØµÙ„Ø©
- ğŸ“‹ ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ù„ÙØ§Øª JSON Ø§Ù„Ù†Ø§ØªØ¬Ø© Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„ Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„
- ğŸ“Š Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„ØªÙ‚Ø§Ø±ÙŠØ± Ù„ØªØ­Ø³ÙŠÙ† Ø£Ù…Ø§Ù† Ø£Ù†Ø¸Ù…ØªÙƒ

### Ù„Ù„Ù†ØªØ§Ø¦Ø¬ Ø§Ù„ÙØ§Ø´Ù„Ø©:
- ğŸ”§ ØªØ­Ù‚Ù‚ Ù…Ù† ØªØ«Ø¨ÙŠØª Ø§Ù„Ù…ØªØ·Ù„Ø¨Ø§Øª
- ğŸ“š Ø±Ø§Ø¬Ø¹ Ø³Ø¬Ù„Ø§Øª Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ù„Ù„Ø­ØµÙˆÙ„ Ø¹Ù„Ù‰ ØªÙØ§ØµÙŠÙ„
- ğŸ”„ Ø­Ø§ÙˆÙ„ ØªØ´ØºÙŠÙ„ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø¨Ø´ÙƒÙ„ ÙØ±Ø¯ÙŠ Ù„Ù„ØªØ´Ø®ÙŠØµ

## Ø§Ù„Ù…Ù„ÙØ§Øª Ø§Ù„Ù†Ø§ØªØ¬Ø©
- ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ù†ØªØ§Ø¦Ø¬: `exploitation_master_results_{timestamp}.json`
- ØªÙ‚Ø§Ø±ÙŠØ± Ø§Ù„Ø§Ø³ØªØºÙ„Ø§Ù„: `exploitation_full_{timestamp}.json`
- ØªÙ‚Ø§Ø±ÙŠØ± Ø¹Ø±Ø¨ÙŠØ©: `arabic_exploitation_results_*.json`
- ØªÙ‚Ø§Ø±ÙŠØ± PoC: `poc_report_*.md`
- ØªÙ‚Ø§Ø±ÙŠØ± Ø¹Ù…Ù„ÙŠØ©: `practical_exploitation_report_*.md`

---

**Ù…Ù„Ø§Ø­Ø¸Ø©**: Ù‡Ø°Ø§ Ø§Ù„ØªÙ‚Ø±ÙŠØ± ØªÙ… Ø¥Ù†Ø´Ø§Ø¤Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† ØªØ´ØºÙŠÙ„ Ø¬Ù…ÙŠØ¹ Ø£Ø¯ÙˆØ§Øª Ø§Ø³ØªØºÙ„Ø§Ù„ Ø§Ù„Ø«ØºØ±Ø§Øª.
"""
    
    report_file = f"ØªÙ‚Ø±ÙŠØ±_ØªØ´ØºÙŠÙ„_Ø§Ù„Ø§Ø¯ÙˆØ§Øª_{timestamp}.md"
    with open(report_file, 'w', encoding='utf-8') as f:
        f.write(report_content)
    
    print(f"ğŸ“ ØªÙ… Ø¥Ù†Ø´Ø§Ø¡ ØªÙ‚Ø±ÙŠØ± Ù†Ù‡Ø§Ø¦ÙŠ: {report_file}")

if __name__ == "__main__":
    main()